<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>飲料訂單表單</title>
    <style>
      /* ... 保持原有的 CSS 样式 ... */
    </style>
  </head>
  <body>
    <h1>飲料訂單系統</h1>
    <form id="orderForm">
      <!-- 單行文字輸入欄位 -->
      <label for="user">大名：</label>
      <input type="text" name="user" id="user" required>
      
      <!-- 單選圓鈕 -->
      <fieldset>
        <legend>甜度：</legend>
        <label><input type="radio" name="sugar" value="L">正常</label>
        <label><input type="radio" name="sugar" value="M" checked>中糖</label>
        <label><input type="radio" name="sugar" value="S">微糖</label>
      </fieldset>
      
      <!-- 核取方塊 -->
      <fieldset>
        <legend>加料：</legend>
        <label><input type="checkbox" name="mix" value="百香果">百香果</label>
        <label><input type="checkbox" name="mix" value="荔枝">荔枝</label>
        <label><input type="checkbox" name="mix" value="芋頭">芋頭</label>
        <label><input type="checkbox" name="mix" value="芒果">芒果</label>
      </fieldset>
      
      <!-- 下拉式選單 -->
      <label for="area">區域：</label>
      <select name="area" id="area">
        <option value="北區">北區</option>
        <option value="中區">中區</option>
        <option value="西區" selected>西區</option>
        <option value="東區">東區</option>
        <option value="南區">南區</option>
      </select>
      
      <!-- 重設、送出 -->
      <p>
        <input type="reset" value="重設">
        <input type="submit" value="送出">
      </p>
    </form>

    <!-- 結果顯示區域 -->
    <div id="result" style="display:none; margin-top: 30px; padding: 20px; background-color: white; border-radius: 8px;">
      <h2>訂單確認</h2>
      <div id="resultContent"></div>
      <button onclick="resetForm()" style="margin-top: 20px; padding: 10px 20px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">返回訂單表單</button>
    </div>

    <script>
      // 後端 API 地址（替換為你的 Replit URL）
      const API_URL = 'http://172.31.69.162:5000/api/order';
      
      // 獲取表單元素
      const form = document.getElementById('orderForm');
      const resultDiv = document.getElementById('result');
      const resultContent = document.getElementById('resultContent');
      
      // 表單提交處理
      form.addEventListener('submit', async (e) => {
        e.preventDefault(); // 阻止表單默認提交
        
        // 收集表單數據
        const formData = new FormData(form);
        
        // 顯示載入中
        resultContent.innerHTML = '<p>提交中...</p>';
        resultDiv.style.display = 'block';
        
        try {
          // 發送 POST 請求到後端 API
          const response = await fetch(API_URL, {
            method: 'POST',
            body: formData
          });
          
          const data = await response.json();
          
          if (data.success) {
            // 顯示訂單結果
            const order = data.data;
            let mixHtml = '';
            
            if (order.mix && order.mix.length > 0) {
              mixHtml = '<ul>' + order.mix.map(item => `<li>${item}</li>`).join('') + '</ul>';
            } else {
              mixHtml = '<span style="color: #999;">無加料</span>';
            }
            
            const sugarText = {
              'L': '正常',
              'M': '中糖',
              'S': '微糖'
            }[order.sugar] || order.sugar;
            
            resultContent.innerHTML = `
              <div style="margin: 10px 0;">
                <strong>大名：</strong> ${order.user}
              </div>
              <div style="margin: 10px 0;">
                <strong>甜度：</strong> ${sugarText}
              </div>
              <div style="margin: 10px 0;">
                <strong>加料：</strong> ${mixHtml}
              </div>
              <div style="margin: 10px 0;">
                <strong>區域：</strong> ${order.area}
              </div>
            `;
          } else {
            resultContent.innerHTML = `<p style="color: red;">錯誤：${data.error}</p>`;
          }
        } catch (error) {
          resultContent.innerHTML = `<p style="color: red;">提交失敗：${error.message}</p>`;
        }
      });
      
      // 重置表單
      function resetForm() {
        form.reset();
        resultDiv.style.display = 'none';
      }
    </script>
  </body>
</html>